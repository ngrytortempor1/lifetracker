# LifeTracker

LifeTrackerは、毎日の習慣・タスク・気分ログをワンタップで記録し、ダッシュボードで振り返りやすくまとめてくれるパーソナルデータアプリです。忙しい日でも「何をやったか」「どんな気分だったか」を逃さず残せるよう、最小限の操作で記録とチェックが完結します。

開発者向けに言えば、JSONLベースのイベントソーシングとプラガブルなストレージ層（JSONL/SQLite）を核に、Jetpack Compose + MVVM構成でリアクティブなダッシュボードや分析機能を提供するモジュラブルなアーキテクチャになっています。

- **バージョン**: v1.0
- **最終更新**: 2025-11-02
- **進捗**: Phase 1（習慣・タスク・分析基盤）進行中

---

## LifeTrackerが他と違う理由
- クラウドに依存せず、イベント履歴を完全ローカルのオープンフォーマット（JSONL）で保持。いつでも他ツールへ持ち出せます。
- 習慣・タスク・クイックログ・ムード・睡眠を同じイベントタイムラインで扱い、横断的な洞察（例: 睡眠とタスク完了率の相関）を計算できます。
- ストレージ層をプラグイン化し、軽量なJSONLモードとRoom(SQLite)モードを切り替え可能。将来のE2EE同期やデータウェアハウス連携にも備えています。
- 収集したイベントをリアルタイムに整形し、ローリング平均やルーチン遷移確率などの分析指標をダッシュボードへ配信します。
- UIの全操作が3タップ以内で完結するよう画面設計されており、クイックログや通知からのタスク追加で「記録の面倒さ」を最小化します。

---

## 主な機能（ユーザー向け）
- **ダッシュボード**: 今日のタスク・習慣・ムード・睡眠をカードで表示。完了率や最新ログが秒単位で更新されます。
- **クイックログ**: タグ付きの短文ログをホーム画面や通知からサッと記録。人気タグや最近のタグを学習して予測入力します。
- **タスクハブ**: My Day/期限/カテゴリごとのビュー、サブタスク、リマインダー、繰り返し設定に対応。通知からのインライン追加も可能。
- **ウェルネス可視化**: 睡眠セッションとムードスコアを並べて表示し、習慣達成とのつながりを後から振り返れます。
- **ローカルファースト**: すべてのデータが端末内のJSONL/SQLiteへ保存され、USB転送やクラウドストレージにコピーするだけでバックアップできます。
- **将来拡張**: Phase 2以降でプラグインAPIやE2EE同期を追加予定。現在のデータ構造がそのまま拡張の土台になります。

---

## 技術構成（開発者向け）
- **アーキテクチャ**: Compose UI → ViewModel → Repository → Storage のMVVMレイヤー構造。DIは `AppContainer` が担い、プラグイン解決やワーカー初期化を集中管理。
- **ストレージ層**: `LifeTrackerStorage` が抽象契約。`JsonStoragePlugin` と `SqliteStoragePlugin` が同じ契約を実装し、設定ファイルからアクティブプラグインを切替えます。SQLiteモードではRoom v4スキーマ、JSONLモードではフラットファイルを使用。
- **イベントソーシング**: `Event` モデルに `EventMetadata` を付与し、タグや詳細を正規化。`ensureMetadata()` で過去イベントも遡及的に整形します。
- **分析パイプライン**: `EventAnalyticsRepository` を介して `EventAnalyticsCalculations` の共通ロジックを呼び出し、ローリング平均・タグ集計・ルーチン遷移確率を生成。データソースはJSONL/SQLiteのどちらでも同じ結果を返します。
- **ウェルネスデータ**: `WellnessRepository` が気分・睡眠をFlowで公開。UIは `DashboardViewModel` で合成し、Composeに渡しています。
- **非同期処理**: Coroutines + Flow、`collectAsStateWithLifecycle` を用いたライフサイクル対応の状態管理。バックグラウンド同期はWorkManager経由。
- **ドキュメント**: `docs/core_plugin_split_plan.md`, `docs/plugin_dependency_overview.md`, `docs/testing_strategy.md` に設計と今後のロードマップを記載。

今後は Phase 4 でユニットテスト・スナップショットテスト整備、ストレージ移行テスト、ログ整備を追加予定です。

---

## セットアップ手順
1. [Android Studio](https://developer.android.com/studio) をインストール
2. このリポジトリをクローンし `LifeTracker/` を開く
3. `local.properties` に `sdk.dir` を設定（必要に応じて）
4. 実機またはエミュレータで `app` モジュールをビルド＆実行

詳細は `docs/開発ガイド.md` と `docs/更新履歴.md` を参照してください。

---

## ディレクトリ概要
```
LifeTracker/
├── app/                   # Android アプリ本体
│   ├── src/main/java/…    # UI, ViewModel, Repository, Plugin 実装
│   └── build.gradle.kts   # アプリ依存
├── kernel/                # 共有ドメインモデル & 契約
├── docs/                  # 設計ドキュメント・開発メモ
└── gradle/                # Gradle ラッパー
```

---

## ライセンス / コントリビュート
- 本リポジトリは [GNU Affero General Public License v3.0](./LICENSE) で提供されます。アプリや派生物をネットワーク経由で提供する場合は、利用者がソースコードへアクセスできるよう案内してください。
- Issue / Pull Request は大歓迎です。バグ報告・改善提案の際は再現手順と環境情報をご共有ください。大きな機能追加は事前にディスカッションをお願いします。

## サポートと有償プラン
LifeTracker は OSS ですが、以下の有償サポートを提供予定です。

- 導入支援・カスタマイズワークショップ
- 優先サポート（SLA 付き問い合わせ対応）
- ホスティング / 自動バックアップオプション

興味のある方は `kirikirinokirin@gmail.com` までお問い合わせください。サポートの詳細や料金は [SUPPORT.md](./SUPPORT.md) にまとめています。

---

開発者: 私とGPT5-codex。ありがとうサム・アルトマン！！！！！！！！
